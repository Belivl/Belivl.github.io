---
import BaseHead from "../components/BaseHead.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";
import { getLocale } from "astro-i18n-aut";
import { ViewTransitions } from "astro:transitions";

import bgPic from "../assets/FilmGrainS5.jpg";
import Container from "../components/Container.astro";
import CookieBanner from "../components/ui/CookieBanner.astro";

const { title, description } = Astro.props;

const locale = getLocale(Astro.url);
---

<script is:inline>
  document.documentElement.classList.add("dark");
</script>
<!-- 
<script is:inline>
  const getThemePreference = () => {
    if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
      return localStorage.getItem("theme");
    }
    return window.matchMedia("(prefers-color-scheme: dark)").matches
      ? "dark"
      : "dark";
  };
  const isDark = getThemePreference() === "dark";
  document.documentElement.classList[isDark ? "add" : "add"]("dark");

  if (typeof localStorage !== "undefined") {
    const observer = new MutationObserver(() => {
      const isDark = document.documentElement.classList.contains("dark");
      localStorage.setItem("theme", isDark ? "dark" : "dark");
    });
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ["class"],
    });
  }
</script>-->
<html lang={locale} class="dark">
  <head>
    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-MNFGXSGS");
    </script>
    <!-- End Google Tag Manager -->

    <BaseHead title={title} description={description} image="" />
    <ViewTransitions />
  </head>
  <body class="bg-grey-500 relative p-0 z-0 h-full">
    <!-- Google Tag Manager (noscript) -->
    <noscript
      ><iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-MNFGXSGS"
        height="0"
        width="0"
        style="display:none;visibility:hidden"></iframe></noscript
    >
    <!-- End Google Tag Manager (noscript) -->

    <!-- //body style="visibility: hidden;"-->
    <CookieBanner />
    <!--Background image -->
    <div class="dark:bg-grey-500 bg-grey-50 fixed w-full h-full -z-[50]"></div>
    <img src={bgPic.src} alt="BGPicture" class="mainBG -z-[100]" />
    <!-- 
    <Navbar />
    -->
    <main id="main" class="w-full flex flex-col">
      <slot />
    </main>
    <!-- 
    <Footer />-->
    <style>
      html,
      body {
        height: 100%;
      }
      body {
        display: grid;
        grid-template-rows: auto 1fr auto;
        height: 100vh;
      }
      main {
        padding: 24px;
        margin: auto;
        height: 100%;
      }
    </style>
    <!-- 
    <script>
      import { getCookie } from "../js/utils";
      const navLinkPortHome = document.querySelector(
        "#navLinkPortHome"
      ) as HTMLLinkElement;
      let currentProfile = getCookie("profile");
      if (currentProfile === "Belial") {
        navLinkPortHome.href = "/home/";
      } else {
        navLinkPortHome.href = "/home2/";
      }
      /** 
      // Helper function
      let domReady = (cb) => {
        document.readyState === "interactive" ||
        document.readyState === "complete"
          ? cb()
          : document.addEventListener("DOMContentLoaded", cb);
      };

      domReady(() => {
        // Display body when DOM is loaded
        document.body.style.visibility = "visible";
      });*/
    </script>-->
    <!-- <script src="js/themeChange"></script>
    <script
      type="module"
      is:inline
      src="/vigorous-virgo/src/js/choiceNavigate.js"></script>-->
    <script>
      0;
    </script>
  </body>
</html>
