---
import { ViewTransitions } from "astro:transitions";
import { getLocale } from "astro-i18n-aut";
import CookieBanner from "@src/components/ui/CookieBanner.astro";
import bgPic from "@assets/FilmGrainS5.jpg";
import Footer from "@src/components/Footer.astro";
import BaseHead from "@components/BaseHead.astro";
const locale = getLocale(Astro.url);
---

<script is:inline>
  const getThemePreference = () => {
    if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
      return localStorage.getItem("theme");
    }
    return window.matchMedia("(prefers-color-scheme: dark)").matches
      ? "dark"
      : "light";
  };
  const isDark = getThemePreference() === "dark";
  document.documentElement.classList[isDark ? "add" : "remove"]("dark");

  if (typeof localStorage !== "undefined") {
    const observer = new MutationObserver(() => {
      const isDark = document.documentElement.classList.contains("dark");
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ["class"],
    });
  }
</script>

<html lang={locale}>
  <head>
    <BaseHead
      title="Portfolio Choice"
      description="Enter desired portfolio site"
      image=""
    />
    <ViewTransitions />
    <!--
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H8G97ZVN7G"
    ></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-H8G97ZVN7G");
    </script></head
  >

   Google tag (gtag.js) -->
  </head>

  <body>
    <CookieBanner />
    <!--Background image -->
    <div class="bgColor bg-grey-500 fixed w-full h-full -z-50"></div>
    <img src={bgPic.src} alt="X" class="mainBG" />
    <div>
      <slot />
      <Footer />
    </div>
    <script src="js/profileSelector.ts"></script>
    <style>
      html,
      body {
        height: 100%;
      }
      body {
        display: grid;
        grid-template-rows: auto 1fr auto;
        height: 100vh;
      }
    </style>
  </body>
</html>
